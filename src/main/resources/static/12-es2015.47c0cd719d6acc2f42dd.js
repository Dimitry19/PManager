(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{XDqi:function(e,o,n){"use strict";n.r(o),n.d(o,"TotpModule",function(){return h});var r=n("ofXK"),t=n("tyNb"),i=n("Cmua"),c=n("EA5N"),s=n("fXoL"),a=n("3Pt+");function d(e,o){1&e&&(s.ac(0,"div"),s.Oc(1,"Le code est requis"),s.Zb())}function l(e,o){1&e&&(s.ac(0,"div"),s.Oc(1,"Le code doit comporter au moins 6 caract\xe8res"),s.Zb())}function u(e,o){if(1&e&&(s.ac(0,"div",12),s.Mc(1,d,2,0,"div",13),s.Mc(2,l,2,0,"div",13),s.Zb()),2&e){s.nc();const e=s.Ec(6);s.Hb(1),s.uc("ngIf",null==e.errors?null:e.errors.required),s.Hb(1),s.uc("ngIf",null==e.errors?null:e.errors.minlength)}}function g(e,o){if(1&e&&(s.ac(0,"div",12),s.Oc(1),s.Zb()),2&e){const e=s.nc(2);s.Hb(1),s.Qc("\xc9chec de la connexion : ",e.errorMessage,"")}}function f(e,o){if(1&e){const e=s.bc();s.ac(0,"form",4,5),s.kc("ngSubmit",function(){s.Gc(e);const o=s.Ec(1),n=s.nc();return o.form.valid&&n.onSubmit()}),s.ac(2,"div",6),s.ac(3,"label",7),s.Oc(4,"Entrez le code \xe0 6 chiffres de votre application d'authentification"),s.Zb(),s.ac(5,"input",8,9),s.kc("ngModelChange",function(o){return s.Gc(e),s.nc().form.code=o}),s.Zb(),s.Mc(7,u,3,2,"div",10),s.Zb(),s.ac(8,"div",6),s.ac(9,"button",11),s.Oc(10,"Connexion"),s.Zb(),s.Zb(),s.ac(11,"div",6),s.Mc(12,g,2,1,"div",10),s.Zb(),s.Zb()}if(2&e){const e=s.Ec(1),o=s.Ec(6),n=s.nc();s.Hb(5),s.uc("ngModel",n.form.code),s.Hb(2),s.uc("ngIf",e.submitted&&o.invalid),s.Hb(5),s.uc("ngIf",n.isLoginFailed)}}const m=[{path:"",component:(()=>{class e{constructor(e,o,n){this.userService=e,this.router=o,this.notifyService=n,this.form={},this.isLoggedIn=!1,this.isLoginFailed=!1,this.errorMessage=""}onSubmit(){const e=this;e.form.username=JSON.parse(sessionStorage.loggedUser).username,console.log(e.form),e.userService.verify(e.form).subscribe(o=>{o.retCode>-1?(sessionStorage.setItem("tokenUser",JSON.stringify(o.accessToken)),e.login(o)):-1==o.retCode&&e.notifyService.showError(o.message,"")},o=>{e.errorMessage=o.error.message,e.isLoginFailed=!0})}login(e){sessionStorage.setItem("tokenUserLogged",JSON.stringify(e)),this.isLoginFailed=!1,this.isLoggedIn=!0,this.userService.setStatus(!0),this.notifyService.showSuccess("Salut "+e.username.toUpperCase(),""),sessionStorage.disclaimerModal||(setTimeout(function(){$("#disclaimerModal").modal({show:!0,backdrop:"static",keyboard:!1})},1500),setTimeout(function(){$("#cookiesSideModalRightBottom").delay(1e3).fadeIn(),sessionStorage.disclaimerModal=1},6e3)),this.router.navigate(["/home"])}}return e.\u0275fac=function(o){return new(o||e)(s.Ub(c.a),s.Ub(t.f),s.Ub(i.a))},e.\u0275cmp=s.Ob({type:e,selectors:[["app-totpfactor"]],decls:4,vars:1,consts:[[1,"col-md-12"],[1,"card","card-container"],["id","profile-img","src","//ssl.gstatic.com/accounts/ui/avatar_2x.png","alt","profile",1,"profile-img-card"],["name","form","novalidate","",3,"ngSubmit",4,"ngIf"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","code"],["type","text","name","code","required","","minlength","6",1,"form-control",3,"ngModel","ngModelChange"],["code","ngModel"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"btn","btn-primary","btn-block"],["role","alert",1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,o){1&e&&(s.ac(0,"div",0),s.ac(1,"div",1),s.Vb(2,"img",2),s.Mc(3,f,13,3,"form",3),s.Zb(),s.Zb()),2&e&&(s.Hb(3),s.uc("ngIf",!o.isLoggedIn))},directives:[r.n,a.z,a.p,a.q,a.b,a.v,a.k,a.o,a.r],styles:[".card-container.card[_ngcontent-%COMP%]{max-width:400px!important;padding:40px}.card[_ngcontent-%COMP%]{background-color:#f7f7f7;padding:20px 25px 30px;margin:50px auto 25px;border-radius:2px;box-shadow:0 2px 2px rgba(0,0,0,.3)}.profile-img-card[_ngcontent-%COMP%]{width:96px;height:96px;margin:0 auto 10px;display:block;border-radius:50%}"]}),e})()}];let b=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=s.Sb({type:e}),e.\u0275inj=s.Rb({imports:[[t.i.forChild(m)],t.i]}),e})();var p=n("HaJA");let h=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=s.Sb({type:e}),e.\u0275inj=s.Rb({imports:[[r.c,p.a,b]]}),e})()}}]);