(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{XDqi:function(e,o,n){"use strict";n.r(o),n.d(o,"TotpModule",function(){return h});var t=n("ofXK"),i=n("tyNb"),r=n("Cmua"),c=n("EA5N"),a=n("fXoL"),s=n("3Pt+");function d(e,o){1&e&&(a.ac(0,"div"),a.Oc(1,"Le code est requis"),a.Zb())}function g(e,o){1&e&&(a.ac(0,"div"),a.Oc(1,"Le code doit comporter au moins 6 caract\xe8res"),a.Zb())}function u(e,o){if(1&e&&(a.ac(0,"div",12),a.Mc(1,d,2,0,"div",13),a.Mc(2,g,2,0,"div",13),a.Zb()),2&e){a.nc();const e=a.Ec(6);a.Hb(1),a.uc("ngIf",e.errors.required),a.Hb(1),a.uc("ngIf",e.errors.minlength)}}function l(e,o){if(1&e&&(a.ac(0,"div",12),a.Oc(1),a.Zb()),2&e){const e=a.nc(2);a.Hb(1),a.Qc("\xc9chec de la connexion : ",e.errorMessage,"")}}function f(e,o){if(1&e){const e=a.bc();a.ac(0,"form",4,5),a.kc("ngSubmit",function(){a.Gc(e);const o=a.Ec(1),n=a.nc();return o.form.valid&&n.onSubmit()}),a.ac(2,"div",6),a.ac(3,"label",7),a.Oc(4,"Entrez le code \xe0 6 chiffres de votre application d'authentification"),a.Zb(),a.ac(5,"input",8,9),a.kc("ngModelChange",function(o){return a.Gc(e),a.nc().form.code=o}),a.Zb(),a.Mc(7,u,3,2,"div",10),a.Zb(),a.ac(8,"div",6),a.ac(9,"button",11),a.Oc(10,"Connexion"),a.Zb(),a.Zb(),a.ac(11,"div",6),a.Mc(12,l,2,1,"div",10),a.Zb(),a.Zb()}if(2&e){const e=a.Ec(1),o=a.Ec(6),n=a.nc();a.Hb(5),a.uc("ngModel",n.form.code),a.Hb(2),a.uc("ngIf",e.submitted&&o.invalid),a.Hb(5),a.uc("ngIf",n.isLoginFailed)}}const m=[{path:"",component:(()=>{class e{constructor(e,o,n){this.userService=e,this.router=o,this.notifyService=n,this.form={},this.isLoggedIn=!1,this.isLoginFailed=!1,this.errorMessage=""}onSubmit(){let e=this;e.form.username=JSON.parse(sessionStorage.loggedUser).username,console.log(e.form),e.userService.verify(e.form).subscribe(o=>{o.retCode>-1?(sessionStorage.setItem("tokenUser",JSON.stringify(o.accessToken)),e.login(o)):-1==o.retCode&&e.notifyService.showError(o.message,"")},o=>{e.errorMessage=o.error.message,e.isLoginFailed=!0})}login(e){sessionStorage.setItem("tokenUserLogged",JSON.stringify(e)),this.isLoginFailed=!1,this.isLoggedIn=!0,this.userService.setStatus(!0),this.notifyService.showSuccess("Salut "+e.username.toUpperCase(),""),sessionStorage.disclaimerModal||(setTimeout(function(){$("#disclaimerModal").modal({show:!0,backdrop:"static",keyboard:!1})},1500),setTimeout(function(){$("#cookiesSideModalRightBottom").delay(1e3).fadeIn(),sessionStorage.disclaimerModal=1},6e3)),this.router.navigate(["/home"])}}return e.\u0275fac=function(o){return new(o||e)(a.Ub(c.a),a.Ub(i.f),a.Ub(r.a))},e.\u0275cmp=a.Ob({type:e,selectors:[["app-totpfactor"]],decls:4,vars:1,consts:[[1,"col-md-12"],[1,"card","card-container"],["id","profile-img","src","//ssl.gstatic.com/accounts/ui/avatar_2x.png","alt","profile",1,"profile-img-card"],["name","form","novalidate","",3,"ngSubmit",4,"ngIf"],["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","code"],["type","text","name","code","required","","minlength","6",1,"form-control",3,"ngModel","ngModelChange"],["code","ngModel"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"btn","btn-primary","btn-block"],["role","alert",1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,o){1&e&&(a.ac(0,"div",0),a.ac(1,"div",1),a.Vb(2,"img",2),a.Mc(3,f,13,3,"form",3),a.Zb(),a.Zb()),2&e&&(a.Hb(3),a.uc("ngIf",!o.isLoggedIn))},directives:[t.n,s.y,s.o,s.p,s.b,s.u,s.j,s.n,s.q],styles:[".card-container.card[_ngcontent-%COMP%]{max-width:400px!important;padding:40px}.card[_ngcontent-%COMP%]{background-color:#f7f7f7;padding:20px 25px 30px;margin:50px auto 25px;border-radius:2px;box-shadow:0 2px 2px rgba(0,0,0,.3)}.profile-img-card[_ngcontent-%COMP%]{width:96px;height:96px;margin:0 auto 10px;display:block;border-radius:50%}"]}),e})()}];let b=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=a.Sb({type:e}),e.\u0275inj=a.Rb({imports:[[i.i.forChild(m)],i.i]}),e})();var p=n("HaJA");let h=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=a.Sb({type:e}),e.\u0275inj=a.Rb({imports:[[t.c,p.a,b]]}),e})()}}]);